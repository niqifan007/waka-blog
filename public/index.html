<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
	<meta name="generator" content="Hugo 0.111.1">
    
      <meta name="theme" content='FixIt v0.2.18-RC'>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>waka&#39;s blog</title><meta name="author" content="">
<meta name="author-link" content="">
<meta name="description" content="è¿™æ˜¯wakaçš„blog" /><meta name="keywords" content='blockchain, IT' /><meta itemprop="name" content="waka&#39;s blog">
<meta itemprop="description" content="è¿™æ˜¯wakaçš„blog"><meta property="og:title" content="waka&#39;s blog" />
<meta property="og:description" content="è¿™æ˜¯wakaçš„blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://blog.579878700.xyz/" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="waka&#39;s blog"/>
<meta name="twitter:description" content="è¿™æ˜¯wakaçš„blog"/>
<meta name="application-name" content="waka&#39;s blog">
<meta name="apple-mobile-web-app-title" content="waka&#39;s blog"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="%e7%8b%90%e7%8b%b8.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://blog.579878700.xyz/" /><link rel="alternate" href="/index.xml" type="application/rss+xml" title="waka&#39;s blog">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="waka&#39;s blog"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebSite",
    "url": "http:\/\/blog.579878700.xyz\/","inLanguage": "zh-CN","description": "è¿™æ˜¯wakaçš„blog","name": "waka's blog"
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="waka&#39;s blog"><img loading="lazy" src="/%e7%8b%90%e7%8b%b8.svg" srcset="/%e7%8b%90%e7%8b%b8.svg, /%e7%8b%90%e7%8b%b8.svg 1.5x, /%e7%8b%90%e7%8b%b8.svg 2x" sizes="auto" data-title="waka&#39;s blog" data-alt="waka&#39;s blog" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">waka&#39;s blog</span></a><span id="typeit-header-subtitle-desktop" class="typeit header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> æ–‡ç« </a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> åˆ†ç±»</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> æ ‡ç­¾</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li>
      </ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="waka&#39;s blog"><img loading="lazy" src="/%e7%8b%90%e7%8b%b8.svg" srcset="/%e7%8b%90%e7%8b%b8.svg, /%e7%8b%90%e7%8b%b8.svg 1.5x, /%e7%8b%90%e7%8b%b8.svg 2x" sizes="auto" data-title="/ç‹ç‹¸.svg" data-alt="/ç‹ç‹¸.svg" class="logo" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/><span class="header-title-text">waka&#39;s blog</span></a><span id="typeit-header-subtitle-mobile" class="typeit header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              å–æ¶ˆ
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> æ–‡ç« </a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> åˆ†ç±»</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> æ ‡ç­¾</a></li><li class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container" data-page-style="normal"><div class="page home posts"><div class="home-profile"><div class="home-avatar"><a href="/posts/" title="æ–‡ç« "><img loading="lazy" src="/images/avatar.jpg" srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes="auto" data-title="/images/avatar.jpg" data-alt="/images/avatar.jpg" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></a></div><h1 class="home-title">Hi ğŸ‘‹ My name is waka</h1><h2 class="home-subtitle"><span class="d-none">è¿™æ˜¯æˆ‘çš„blog</span>
        <span id="typeit-profile-subtitle" class="typeit"></span></h2><div class="links"><a href="/index.xml" title="RSS"target="_blank" rel="external nofollow noopener noreferrer me"><i class="fa-solid fa-rss fa-fw" aria-hidden="true"></i>
    </a></div></div>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
    <a href="/posts/solidity_curd/">solidityåŠ¨æ€æ•°ç»„çš„å¢åˆ æ”¹æŸ¥</a>
  </h1><div class="post-meta"><span class="post-author"><span class="author"><img loading="lazy" src="/images/avatar.jpg" srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes="auto" data-title="waka" data-alt="waka" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;waka</span></span>&nbsp;<span class="post-publish" title='2023-03-17 00:35:21'>å‘å¸ƒäº <time datetime="2023-03-17">2023-03-17</time></span>&nbsp;<span class="post-category">æ”¶å½•äº <a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> åŒºå—é“¾</a></span></div><div class="content"><h2 id="æ•°ç»„ç±»å‹">æ•°ç»„ç±»å‹</h2>
<p>Solidityæ”¯æŒä¸¤ç§æ•°ç»„: é™æ€æ•°ç»„å’ŒåŠ¨æ€æ•°ç»„ã€‚</p>
<p>åˆåˆ†<code>storage</code>ä¸<code>memory</code>å‹æ•°ç»„</p>
<pre tabindex="0"><code>uint[] memory list;
//å˜é•¿memoryæ•°ç»„ï¼Œä½¿ç”¨å‰å¿…é¡»ç¡®å®šé•¿åº¦
list =new uint[](a);
//ç„¶åå†ä½¿ç”¨ï¼Œä¸€èˆ¬ç”¨åœ¨å‡½æ•°å†…
memoryå‹æ•°ç»„ä¸èƒ½ä½¿ç”¨pop,pushä¹Ÿä¸èƒ½ä¿®æ”¹length
</code></pre><h3 id="é™æ€æ•°ç»„">é™æ€æ•°ç»„</h3>
<pre tabindex="0"><code>// å›ºå®šé•¿åº¦ä¸º2çš„é™æ€æ•°ç»„å®šä¹‰
uint[2] fixedArray;
//å®šé•¿æ•°ç»„å®ä¾‹åŒ–
fixedArray = [4, 6];
</code></pre><p>é™æ€æ•°ç»„ä¸å¯æ–°å¢å…ƒç´ ï¼Œä½†å¯ä¿®æ”¹ç°æœ‰å…ƒç´ çš„å€¼ã€‚</p>
<h3 id="åŠ¨æ€æ•°ç»„">åŠ¨æ€æ•°ç»„</h3>
<p>åŠ¨æ€æ•°ç»„ï¼Œé•¿åº¦ä¸å›ºå®šï¼Œå¯ä»¥åŠ¨æ€æ·»åŠ å…ƒç´ ã€‚</p>
<pre tabindex="0"><code>//å£°æ˜
uint[] dynamicArray;
//åˆå§‹åŒ–ï¼Œè¿™é‡Œå®ä¾‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º2çš„æ•°ç»„ï¼Œå€¼ä¸º0ã€‚
dynamicArray = new uint[](2);
</code></pre><div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">105
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-solidity" data-lang="solidity"><span style="display:flex;"><span><span style="color:#7f848e">// SPDX-License-Identifier: MIT
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">pragma solidity</span> <span style="color:#56b6c2">^</span><span style="color:#d19a66">0</span>.<span style="color:#d19a66">8</span>.<span style="color:#d19a66">9</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">library</span> <span style="color:#e06c75">Array</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">push</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>, <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_num</span>) <span style="color:#c678dd">internal</span> <span style="color:#c678dd">pure</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">assembly</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#7f848e">// åœ¨å¯å˜æ•°ç»„çš„ æœ«å°¾è¿½åŠ  ä¸€ä¸ªvalue (_num)
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>            <span style="color:#61afef;font-weight:bold">mstore</span>(<span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#e06c75">_nums</span>, <span style="color:#61afef;font-weight:bold">mul</span>(<span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#e06c75">_nums</span>), <span style="color:#d19a66">1</span>), <span style="color:#d19a66">0x20</span>)), <span style="color:#e06c75">_num</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#7f848e">// å¯å˜æ•°ç»„çš„length åŠ  1
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>            <span style="color:#61afef;font-weight:bold">mstore</span>(<span style="color:#e06c75">_nums</span>, <span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#e06c75">_nums</span>), <span style="color:#d19a66">1</span>))
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#7f848e">// 0x40 æ˜¯ç©ºé—²å†…å­˜æŒ‡é’ˆçš„é¢„å®šä¹‰ä½ç½® (value ä¸º ç©ºé—²æŒ‡é’ˆå¼€å§‹ä½)
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>            <span style="color:#61afef;font-weight:bold">mstore</span>(<span style="color:#d19a66">0x40</span>, <span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#d19a66">0x40</span>), <span style="color:#d19a66">0x20</span>))
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">pop</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>) <span style="color:#c678dd">internal</span> <span style="color:#c678dd">pure</span> <span style="color:#c678dd">returns</span> (<span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">num_</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">assembly</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#7f848e">// å–å‡ºå¯å˜æ•°ç»„çš„æœ€åä¸€ä¸ªvalue
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>            <span style="color:#e06c75">num_</span> <span style="color:#56b6c2">:=</span> <span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#e06c75">_nums</span>, <span style="color:#61afef;font-weight:bold">mul</span>(<span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#e06c75">_nums</span>), <span style="color:#d19a66">0x20</span>)))
</span></span><span style="display:flex;"><span>            <span style="color:#7f848e">// length - 1
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>            <span style="color:#61afef;font-weight:bold">mstore</span>(<span style="color:#e06c75">_nums</span>, <span style="color:#61afef;font-weight:bold">sub</span>(<span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#e06c75">_nums</span>), <span style="color:#d19a66">1</span>))
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">del</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>, <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_index</span>) <span style="color:#c678dd">internal</span> <span style="color:#c678dd">pure</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">assembly</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#7f848e">// ä¸‹æ ‡ä½ç½®éœ€ å°äº æ•°ç»„.length
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>            <span style="color:#e06c75">if</span> <span style="color:#61afef;font-weight:bold">lt</span>(<span style="color:#e06c75">_index</span>, <span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#e06c75">_nums</span>)) {
</span></span><span style="display:flex;"><span>                <span style="color:#7f848e">// å°†æœ€åä¸€ä¸ªvalue ç§»åˆ° _index ä¸‹æ ‡å¤„ 
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>                <span style="color:#61afef;font-weight:bold">mstore</span>(
</span></span><span style="display:flex;"><span>                    <span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#e06c75">_nums</span>, <span style="color:#61afef;font-weight:bold">mul</span>(<span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#e06c75">_index</span>, <span style="color:#d19a66">1</span>), <span style="color:#d19a66">0x20</span>)),
</span></span><span style="display:flex;"><span>                    <span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#61afef;font-weight:bold">add</span>(<span style="color:#e06c75">_nums</span>, <span style="color:#61afef;font-weight:bold">mul</span>(<span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#e06c75">_nums</span>), <span style="color:#d19a66">0x20</span>)))
</span></span><span style="display:flex;"><span>                )
</span></span><span style="display:flex;"><span>                <span style="color:#7f848e">// length - 1
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>                <span style="color:#61afef;font-weight:bold">mstore</span>(<span style="color:#e06c75">_nums</span>, <span style="color:#61afef;font-weight:bold">sub</span>(<span style="color:#61afef;font-weight:bold">mload</span>(<span style="color:#e06c75">_nums</span>), <span style="color:#d19a66">1</span>))
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">update</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_index</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_num</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#c678dd">internal</span> <span style="color:#c678dd">pure</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">_nums</span>[<span style="color:#e06c75">_index</span>] <span style="color:#56b6c2">=</span> <span style="color:#e06c75">_num</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">get</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>, <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_index</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">internal</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">pure</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">returns</span> (<span style="color:#e5c07b">uint256</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">_nums</span>[<span style="color:#e06c75">_index</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">contract</span> <span style="color:#e5c07b">testArr</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">using</span> <span style="color:#e06c75">Array</span> <span style="color:#c678dd">for</span> <span style="color:#e5c07b">uint256</span>[];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">push</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>, <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">num</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">external</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">pure</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">returns</span> (<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">_nums</span>.<span style="color:#e06c75">push</span>(<span style="color:#e06c75">num</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">_nums</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">pop</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">external</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">pure</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">returns</span> (<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span>, <span style="color:#e5c07b">uint256</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">num_</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">_nums</span>.<span style="color:#e06c75">pop</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> (<span style="color:#e06c75">_nums</span>, <span style="color:#e06c75">num_</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">del</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>, <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_index</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">external</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">pure</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">returns</span> (<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">_nums</span>.<span style="color:#e06c75">del</span>(<span style="color:#e06c75">_index</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">_nums</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">update</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_index</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_num</span>
</span></span><span style="display:flex;"><span>    ) <span style="color:#c678dd">external</span> <span style="color:#c678dd">pure</span> <span style="color:#c678dd">returns</span> (<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">_nums</span>.<span style="color:#e06c75">update</span>(<span style="color:#e06c75">_index</span>, <span style="color:#e06c75">_num</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">_nums</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">function</span> <span style="color:#61afef;font-weight:bold">get</span>(<span style="color:#e5c07b">uint256</span>[] <span style="color:#c678dd">memory</span> <span style="color:#e06c75">_nums</span>, <span style="color:#e5c07b">uint256</span> <span style="color:#e06c75">_index</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">external</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">pure</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">returns</span> (<span style="color:#e5c07b">uint256</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">_nums</span>.<span style="color:#e06c75">get</span>(<span style="color:#e06c75">_index</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer">
    <a href="/posts/solidity_curd/">é˜…è¯»å…¨æ–‡</a><div class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/solidity/' class="post-tag">solidity</a><a href='/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/' class="post-tag">åŒºå—é“¾</a></div></div>
</article>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
    <a href="/posts/orderbook/">OrderBookçš„å®ç°æ€è·¯</a>
  </h1><div class="post-meta"><span class="post-author"><span class="author"><img loading="lazy" src="/images/avatar.jpg" srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes="auto" data-title="waka" data-alt="waka" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;waka</span></span>&nbsp;<span class="post-publish" title='2023-03-15 23:36:31'>å‘å¸ƒäº <time datetime="2023-03-15">2023-03-15</time></span>&nbsp;<span class="post-category">æ”¶å½•äº <a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> åŒºå—é“¾</a></span></div><div class="content"><h2 id="ä»€ä¹ˆæ˜¯orderbook">ä»€ä¹ˆæ˜¯OrderBook</h2>
<p><strong>OrderBookæ˜¯ä¸€ä¸ªåŒ…å«äº†æ‰€æœ‰äº¤æ˜“è€…ä¿¡æ¯çš„è®¢å•é›†åˆ</strong>ï¼Œä»–ä»¬æƒ³ä¹°æˆ–è€…æƒ³å–ã€‚<strong>æƒ³ä¹°çš„orderå«åšbidï¼Œæƒ³å–çš„orderå«åšask</strong>ï¼Œè¿™äº›bidå’Œaskçš„orderä¸€æ—¦æ»¡è¶³äº†å„è‡ªçš„æ¡ä»¶ï¼Œå°±ä¼šå°½å¯èƒ½å¿«çš„å®Œæˆé…å¯¹ï¼Œä¿ƒæˆä¸€ç¬”äº¤æ˜“ã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªç§ç±»çš„orderéœ€è¦ä»‹ç»ä¸€ä¸‹ï¼Œå®ƒä»¬ä¹Ÿæ˜¯æœ€ä¸ºåŸºæœ¬çš„äº¤æ˜“è®¢å•ã€‚<strong>ç¬¬ä¸€ç§æ˜¯å¸‚ä»· market orderï¼Œä¹°å’Œå–éƒ½æ˜¯ä¾æ®å½“å‰åœ¨orderbookèƒ½å¯»æ‰¾åˆ°çš„æœ€ä¼˜ä»·æ ¼æ‰§è¡Œ</strong>ã€‚<strong>ç¬¬äºŒç§æ˜¯é™ä»· limit orderï¼Œä¹°å’Œå–éƒ½æ˜¯æŒ‰ç…§å·²ç»ç¡®å®šé‡å’Œä»·æ ¼è¿›è¡Œ</strong>ã€‚OrderBookæ˜¯ä¼ ç»Ÿé‡‘èä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„äº¤æ˜“æ–¹å¼ï¼Œé€šè¿‡OrderBookä¸­æ˜¾ç¤ºçš„ä¿¡æ¯ï¼Œå¯ä»¥åˆ¤æ–­å½“å‰å¸‚åœºçš„ä¾›éœ€å…³ç³»ä»¥åŠä»·æ ¼å…³ç³»ï¼ŒåŸºäºä»¥ä¸Šçš„åˆ¤æ–­å¯ä»¥å¯¹å¸‚åœºä¸­çš„ä¸‹ä¸€æ­¥å‘ç”Ÿçš„å˜åŒ–è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ã€‚<strong>åœ¨å»ä¸­å¿ƒåŒ–é‡‘è(Defi)ï¼Œåˆšå¼€å§‹å‘å±•æ—¶ä¹Ÿå€Ÿé‰´åˆ°äº†OrderBookçš„æ¨¡å¼</strong>ï¼Œç”±äºä¼ ç»Ÿçš„OrderBookç”±ä¸­å¿ƒåŒ–æœºæ„è¿›è¡Œç»™å‡ºï¼Œå¯¼è‡´äº†ä¿¡æ¯ä¸­å¿ƒåŒ–ä¸é€æ˜ã€‚æ‰€ä»¥åœ¨Defiä¸­æƒ³å®ç°ä¸€ä¸ªOrderBookå®Œå…¨åªæœ‰ä¹°æ–¹å’Œå–æ–¹è¿›è¡Œå‚ä¸ï¼Œè€Œæœºæ„åªæ”¶å–ç›¸ä¾çš„æ‰‹ç»­è´¹å³å¯ã€‚<br>
çœ‹èµ·æ¥è¿™æ ·çš„æƒ³æ³•æ˜¯ä¸€ç§å¾ˆä¸é”™çš„æƒ³æ³•ï¼Œæä¾›äº†ä¸€ä¸ªæ›´åŠ å…¬å¹³å’Œè‡ªç”±åº¦æ›´é«˜çš„ä¸€ä¸ªå¸‚åœºè®©äººä»¬å»æ“ä½œã€‚ä½†æ˜¯åœ¨å®é™…ä¸­è¿›è¡Œæ—¶ä¼šå‘ç°é—®é¢˜ï¼š</p>
<ul>
<li><strong>å¯¹äºOrderBookéœ€æ±‚æ¥è¯´æ•´ä¸ªåŒºå—é“¾ç½‘ç»œä¸­äº¤æ˜“æˆäº¤çš„é€Ÿç‡å’Œæ•°é‡éƒ½æ— æ³•æ»¡è¶³</strong>ï¼Œå³ä½¿ä»¥å¤ªåŠçš„é€Ÿç‡ç›¸è¾ƒäºæ¯”ç‰¹å¸ç½‘ç»œæœ‰äº†å¾ˆå¤§çš„æé«˜ã€‚</li>
<li>åœ¨äº¤æ˜“ä¸­æœ‰gasçš„å­˜åœ¨ï¼Œ<strong>å¦‚æœæ²¡æœ‰ä¸€ç§å¾ˆå¥½çš„æ–¹æ³•å»å®šä½åˆ°åˆé€‚çš„è®¢å•çš„è¯ï¼Œéšç€è®¢å•æ•°é‡çš„å˜å¤šï¼Œæ‰¾åˆ°ç›¸åº”è®¢å•æ‰€éœ€çš„gasä¼šæ¶ˆè€—å¾ˆå¤§</strong>ã€‚å¹¶ä¸”æ¯ç¬”äº¤æ˜“éƒ½æœ‰ä¸€ä¸ªgasä¸Šé™ï¼Œå½“gasè¾¾åˆ°ç›¸åº”ä¸Šé™çš„æ—¶å€™å°±ä¼šå¯¼è‡´äº¤æ˜“å¤±è´¥ã€‚</li>
</ul>
<h2 id="å®ç°orderbookæ€è·¯">å®ç°OrderBookæ€è·¯</h2>
<h2 id="ä¸€èˆ¬çš„æ€è·¯">ä¸€èˆ¬çš„æ€è·¯</h2>
<p>æŠ›å¼€ä»¥å¤ªåŠç‰¹æ®Šçš„æ¡ä»¶ï¼Œæˆ‘ä»¬åœ¨å®ç°OrderBookçš„æ—¶å€™ï¼Œé‡‡ç”¨çš„æœ€å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯è›®åŠ›æ³•ã€‚æ€è·¯ï¼š</p>
<ul>
<li>åˆ›å»ºä¹°å•å’Œä¹°å•ä¸¤ä¸ªæ•°ç»„</li>
<li>å½“æœ‰ä¹°å•åˆ›å»ºçš„æ—¶å€™ï¼Œå¯¹ä¹°å•æ•°ç»„è¿›è¡Œéå†ï¼Œæ‰¾åˆ°å¯¹åº”ä»·æ ¼å¯¹åº”æ•°é‡çš„è®¢å•ï¼Œå®Œæˆä¸€ç¬”äº¤æ˜“ã€‚å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°†ä¹°å•åŠ å…¥ä¹°å•æ•°ç»„ã€‚åŒç†åˆ›å»ºå–å•æ—¶ä¹Ÿè¿›è¡Œç›¸åº”çš„æ“ä½œã€‚</li>
</ul>
<p>è¿™ä¸ªæ–¹æ³•èƒ½ç¡®ä¿æ‰¾åˆ°æ‰€éœ€è¦çš„çš„äº¤æ˜“ï¼Œä½†æ˜¯<strong>æ•´ä¸ªè¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)</strong>,ç„¶åå¯ä»¥è¿›è¡Œå¹¶å‘å’Œäº’æ–¥é”ç»“åˆï¼Œå¯ä»¥åœ¨çŸ­æ—¶é—´å†…å¤„ç†å¤§é‡çš„ä¹°å•å’Œä¹°å•æ»¡è¶³éœ€æ±‚ã€‚ä½†æ˜¯éšç€è®¢å•é‡çš„å¢å¤šï¼Œæ‰€éœ€è¦çš„æ—¶é—´ä¹Ÿä¼šå¢å¤šï¼Œè¿™åœ¨é“¾ä¸Šå’Œé“¾ä¸‹çš„ç¯å¢ƒä¸­éƒ½æ˜¯ä¸èƒ½æ¥å—çš„ã€‚<br>
ä½†æ˜¯ï¼Œå¦‚æœä¸é‡‡ç”¨è›®åŠ›æ³•çš„è¯ï¼Œå°†<strong>ä¹°å•å’Œå–å•åˆ†åˆ«ç”¨æ’åºäºŒå‰æ ‘çš„æ–¹å¼è¿›è¡Œæ•°æ®ä¿å­˜ï¼Œé‚£æ ·çš„è¯æ—¶é—´å¤æ‚åº¦å°±ä¼šå˜ä¸ºO(logn)</strong>ï¼Œè¿™æ ·å¯ä»¥ä¼˜åŒ–æŸ¥æ‰¾ï¼Œåªæ˜¯åœ¨æ’å…¥æ˜¯æœ‰ç‚¹éº»çƒ¦ã€‚</p>
<h2 id="æ¢ç§æ€è·¯">æ¢ç§æ€è·¯</h2>
<p>åœ¨æ™ºèƒ½åˆçº¦ä¸­æˆ‘ä»¬è¦å°½é‡é¿å…æ—¶ä½¿ç”¨å¾ªç¯çš„æ–¹å¼ï¼Œè¿™æ˜¯å¾ˆè´¹gasçš„ã€‚è€Œä¸ºäº†ç¡®ä¿èƒ½å¤Ÿå¾—åˆ°æƒ³è¦çš„ä»·æ ¼ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾è®¡ï¼š</p>
<ul>
<li>åˆ›å»ºä¸¤ä¸ªä¹°å•å’Œå–å•çš„ä¸¤ä¸ªæ˜ å°„
<ul>
<li><code>mapping(uint =&gt; mapping(uint =&gt; address[])) Bid;</code></li>
<li><code>mapping(uint =&gt; mapping(uint =&gt; address[])) Ask;</code></li>
<li><strong>å‰ä¸€ä¸ªuintæ˜¯ä»·æ ¼ï¼Œç¬¬äºŒä¸ªuintæ˜¯æ•°é‡ï¼Œæœ€åé¢çš„æ˜¯å–æ–¹æˆ–ä¹°æ–¹çš„åœ°å€</strong>ï¼›</li>
</ul>
</li>
<li>æ¯æ¬¡æœ‰ä¹°å•å’Œå–å•è¿›æ¥çš„æ—¶å€™ï¼Œåœ¨mappingä¸­è¿›è¡Œæœç´¢ï¼Œå®Œæˆäº¤æ˜“ã€‚æœç´¢ä¸åˆ°çš„è¯åŠ å…¥å¯¹åº”çš„mappingä¸­å³å¯ã€‚</li>
</ul>
<p>çœ‹ä¸Šå»è¿™æ ·çš„ä¸¤ä¸ªæ˜ å°„å¯ä»¥è§£å†³ä¹°å–åŒæ–¹çš„è®¢å•çš„æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦é—®é¢˜ï¼ˆ<strong>å°†æ—¶é—´å¤æ‚åº¦é™ä¸ºO(1)</strong>ï¼‰ã€‚ä½†æ˜¯è¿™æ ·å´å¿½ç•¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¿™æ ·åšæˆ‘ä»¬æ— æ³•çœ‹åˆ°æ•´ä¸ªå¸‚åœºçš„å˜åŒ–å’Œè¶‹åŠ¿ã€‚æˆ‘ä»¬è¿™æ ·è®¾è®¡ä»£ç çš„è¯åªæ˜¯å®ç°äº†OrderBookçš„ä¸€éƒ¨åˆ†åŠŸèƒ½ã€‚å¦‚æœæƒ³è¦å®ç°OrderBookï¼Œè¿˜æœ‰å¾ˆå¤šè¦è¿›è¡Œä¿®æ”¹çš„åœ°æ–¹ã€‚</p>
<h2 id="ç¬¬ä¸‰ç§æ€è·¯">ç¬¬ä¸‰ç§æ€è·¯</h2>
<p>åœ¨é“¾ä¸Šå°½é‡ä¸è¦ä½¿ç”¨å¤§å¾ªç¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°†å¤§å¾ªç¯å˜ä¸ºå°çš„å¾ªç¯ï¼Œè¿™æ ·æ¥è¯´æ˜¯å¯ä»¥çš„ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿè¦åæ˜ æ•´ä¸ªOrderBookçš„å˜åŒ–ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¾è®¡ä¸€ä¸ªå‹ç¼©å‰ç¼€æ ‘ï¼š</p>
<ul>
<li><strong>æ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä¸ºæ•°å­—0~9ï¼Œè¿™æ ·ä»å¤´ç»“ç‚¹åˆ°å¶å­èŠ‚ç‚¹å‰çš„èŠ‚ç‚¹å°±å¯ä»¥è¿æˆä¸€ä¸²æ•°å­—ï¼Œè¿™ä¸ªæ•°å­—è¡¨ç¤ºé‡‘é¢</strong>ï¼Œæ¯ä¸ªå¶å­èŠ‚ç‚¹å‚¨å­˜çš„æ˜¯è®¢å•æ•°ç»„ï¼Œæ¯ä¸ªè®¢å•ä¿å­˜äº†åœ¨æ­¤é‡‘é¢ä¸‹çš„æ•°é‡å’Œåœ°å€ã€‚</li>
<li>åŒæ ·æ ‘ä¹Ÿè¦åˆ†ä¸¤é¢—æ ‘ï¼Œä¹°å®¶æ ‘å’Œå–å®¶æ ‘ã€‚</li>
<li><strong>æ¯æ¬¡æœ‰æ–°é‡‘é¢å‡ºç°æ—¶ï¼Œè¦å¯¹æ ‘è¿›è¡Œä¿®æ”¹</strong>ï¼Œå¯¹æ ‘è¿›è¡Œæ‰©å±•ï¼Œä¿è¯ä»å¤´åˆ°å°¾è¿æˆçš„æ•°å­—ä¸ºé‡‘é¢ã€‚</li>
<li><strong>åŒæ—¶å½“é‡‘é¢å¯¹åº”çš„å¶å­èŠ‚ç‚¹ä¸­æ•°ç»„é•¿åº¦ä¸º0æ—¶ï¼Œè¦å¯¹æ ‘è¿›è¡Œåˆ é™¤</strong>ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¿è¯åœ¨å¯¹æ ‘éå†æ—¶å‡å°‘æ—¶é—´æ¶ˆè€—ã€‚</li>
<li><strong>åœ¨æ–°ä¹°å•åˆ›å»ºæ—¶ï¼Œå…ˆåœ¨å–å®¶æ ‘ä¸­æ‰¾åˆ°å¯¹åº”é‡‘é¢çš„æ•°ç»„ï¼Œåœ¨å¯¹æ•°ç»„è¿›è¡Œéå†æ‰¾åˆ°å¯¹åº”é‡‘é¢(æ­¤æ—¶å°±å°†å¤§å¾ªç¯ä¼˜åŒ–ä¸ºä¸€ä¸ªå°å¾ªç¯)</strong>ï¼Œæ‰¾åˆ°å¯¹åº”è®¢å•åå°±æˆäº¤äº¤æ˜“ã€‚æ²¡æ‰¾åˆ°çš„è¯å°±å°†å…¶åŠ å…¥ä¹°å®¶æ ‘ã€‚(åŒç†ï¼Œå–å•ä¹Ÿæ˜¯è¿™æ ·å¤„ç†)</li>
</ul>
<p>è¿™æ ·çš„è¯å°±å¯ä»¥å…¼é¡¾å¸‚åœºå˜åŒ–å’ŒæŒ‚å•çš„éœ€æ±‚ã€‚</p>
<h2 id="é—®é¢˜">é—®é¢˜</h2>
<p>ä»¥ä¸Šçš„æ€è·¯éƒ½å¯ä»¥å®ç°OrderBookï¼Œä½†æ˜¯è¿˜æœ‰è®¸å¤šé—®é¢˜éœ€è¦è¿›è¡Œè€ƒè™‘ï¼š</p>
<ul>
<li>å¦‚æœå¯¹åº”çš„æ•°é‡æ‰¾ä¸åˆ°ï¼Œä½†æ˜¯å­˜åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è®¢å•ä¹‹å’Œæ»¡è¶³è¦æ±‚çš„æ—¶å€™ï¼Œè¦æ€ä¹ˆè¿›è¡Œå¤„ç†ï¼Ÿ<strong>åœ¨æ—¶é—´å¤æ‚åº¦è¾ƒå°çš„å‰æä¸‹å¦‚ä½•å®Œæˆè¿™ä¸ªæ‹†åˆ†å¯»æ‰¾çš„è¿‡ç¨‹ï¼Ÿ</strong></li>
<li><strong>æ•´ä¸ªæ ‘çš„ç»“æ„è¦å¦‚ä½•è®¾è®¡ï¼Ÿæ‰èƒ½ä½¿å¾—åœ¨å¢åˆ æ”¹æŸ¥è¾ƒä¸ºæ–¹ä¾¿ï¼Ÿ</strong></li>
</ul>
<h2 id="ç»“å°¾">ç»“å°¾</h2>
<p>è™½ç„¶ç°åœ¨ä¸»æµçš„DEXæ²¡æœ‰ä½¿ç”¨OrderBookï¼Œè€Œæ˜¯ä½¿ç”¨LPè¿™æ ·çš„æ–¹å¼ï¼Œä½†æ˜¯LPä¹Ÿä¼šå­˜åœ¨ç€å¾ˆå¤šçš„é—®é¢˜éœ€è¦è§£å†³ã€‚æ­£æ˜¯å› ä¸ºOrderBookçš„ä¸€äº›åŠŸèƒ½æ— æ³•æ»¡è¶³Defiçš„éœ€æ±‚ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰LPçš„å‡ºç°ã€‚æŠ€æœ¯çš„é€‚ç”¨æ€§æ˜¯éœ€è¦ç»“åˆéœ€æ±‚çš„ã€‚æˆ–è®¸åœ¨ä»¥åå¯èƒ½ä¼šäº§ç”Ÿé€‚åº”åŒºå—é“¾çš„OrderBookã€‚</p></div><div class="post-footer">
    <a href="/posts/orderbook/">é˜…è¯»å…¨æ–‡</a><div class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/' class="post-tag">åŒºå—é“¾</a><a href='/tags/orderbook/' class="post-tag">OrderBook</a></div></div>
</article>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
    <a href="/posts/ai_draw/">AI ç»˜ç”» Stable Diffusion å‚»ç“œåŒ… &#43; æ¨¡å‹ä¸‹è½½åˆ†äº«</a>
  </h1><div class="post-meta"><span class="post-author"><span class="author"><img loading="lazy" src="/images/avatar.jpg" srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes="auto" data-title="waka" data-alt="waka" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;waka</span></span>&nbsp;<span class="post-publish" title='2023-03-14 01:38:33'>å‘å¸ƒäº <time datetime="2023-03-14">2023-03-14</time></span>&nbsp;<span class="post-category">æ”¶å½•äº <a href="/categories/stable-diffusion/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Stable Diffusion</a></span></div><div class="content"><h2 id="stable-diffusion">Stable Diffusion</h2>
<a class="lightgallery" href="https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg" data-thumbnail="https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg" data-sub-html="<h2>https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg</h2>"><img loading="lazy" src="https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg" srcset="https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg, https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg 1.5x, https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg 2x" sizes="auto" data-title="https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg" data-alt="https://original-game.com/wp-content/uploads/2023/02/makima-eyecatch2-1200x630.jpg" width="2316px" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></a>
<p>Stable Diffusion å¤§æ¦‚æ˜¯æ—¶ä¸‹æœ€æµè¡Œçš„ä¸¤ä¸ªé¡¹ç›®ä¹‹ä¸€ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯å¤§åé¼é¼çš„ ChatGPT äº†ã€‚</p>
<p>å¯¹äº Stable Diffusion æœ€ç®€å•çš„ç†è§£ï¼Œå°±æ˜¯æ–‡å­—è½¬å›¾ç‰‡ï¼Œåªéœ€è¦æè¿°ä¸€æ®µæ–‡å­—ï¼ˆæ¯”å¦‚ï¼šä¸€åªåœ¨è‰åœ°ä¸Šçš„ç™½è‰²å°çŒ«å’ªï¼‰ï¼Œå®ƒå°±èƒ½å¸®ä½ ç”Ÿæˆä¸€å¼ å›¾ç‰‡ã€‚è€Œéšç€æŠ€æœ¯çš„è¿­ä»£ï¼Œç›®å‰ Stable Diffusion å·²ç»èƒ½å¤Ÿç”Ÿæˆéå¸¸è‰ºæœ¯åŒ–çš„å›¾ç‰‡äº†ï¼Œå®Œå…¨æœ‰èµ¶è¶…äººç±»çš„æ¶åŠ¿ã€‚</p>
<p>ç”šè‡³ï¼Œå·²ç»æœ‰ä¸å°‘å·¥ä½œè¢«è¿™ç±»æœåŠ¡æ›¿ä»£ï¼Œæ¯”å¦‚åˆ¶ä½œä¸€ä¸ª logo å›¾ç‰‡ï¼Œç”»ä¸€å¼ è™šæ‹Ÿè€å©†ç…§ç‰‡ï¼Œç”»è´¨å ªæ¯”ç›¸æœºã€‚</p>
<hr>
<h2 id="stable-diffusion-å‚»ç“œåŒ…">Stable Diffusion å‚»ç“œåŒ…</h2>
<p>å…ˆæ¥çœ‹ä¸€æ®µè§†é¢‘ï¼š
<div class="bilibili"><iframe src="//player.bilibili.com/player.html?bvid=BV1ne4y1V7QU&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe></div></p>
<p>Stable Diffusion å‚»ç“œåŒ…é‡ŒåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>SD-WebUI å¯åŠ¨å™¨ï¼ˆå¼€å‘è€… ç§‹è‘‰aaakiï¼‰</li>
<li>æ•°æ®æ•´åˆåŒ…</li>
</ol>
<p>å…¶ä¸­ï¼Œ1 ä¸º 2 æœåŠ¡ï¼Œå°†å…¶è§£å‹ç¼©åæ”¾åˆ°æ•°æ®æ•´åˆåŒ…ä¸­å¯åŠ¨å³å¯ã€‚è¿™å¯ä»¥è®©ç”¨æˆ·ä¸å†éœ€è¦æ‰‹åŠ¨å¯åŠ¨å„ä¸ªè„šæœ¬ï¼Œå³å¼€å³ç”¨ã€‚1 ä¸­ç”šè‡³è¿˜åŒ…æ‹¬è½¯ä»¶æ›´æ–°ã€æ±‰åŒ–ã€ç®¡ç†æ¨¡å‹ã€ç–‘éš¾æ‰«æä¿®å¤ï¼Œåæ­£å¾ˆæ–¹ä¾¿å•¦ã€‚</p>
<p>å¯¹äºæƒ³è¦å…¥é—¨æŠ˜è…¾ Stable Diffusionï¼ˆ<a href="https://stablediffusionweb.com/"target="_blank" rel="external nofollow noopener noreferrer">å®˜ç½‘<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>ï¼‰çš„åŒå­¦æ¥è¯´ï¼Œå¯ä»¥è¯•è¯•ã€‚<br>
è¿˜å¯ä»¥ç›´æ¥ä¸‹è½½åˆ«äººè®­ç»ƒå¥½çš„LoRAæ¨¡å‹ï¼Œç›´æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œä¸ç”¨è‡ªå·±è®­ç»ƒã€‚</p>
<p>ç½‘å€: <a href="https://civitai.com"target="_blank" rel="external nofollow noopener noreferrer">https://civitai.com<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a><br>
å…·ä½“æ•™ç¨‹å¯ä»¥çœ‹è¿™ä¸ªè§†é¢‘ï¼š<br>
<div class="bilibili"><iframe src="//player.bilibili.com/player.html?bvid=BV1Py4y1d7eJ&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe></div>
ç‰¹åˆ«æ˜¯è¿™ä¸ªupä¸»ä¹Ÿåˆ†äº«äº†å¾ˆå¤šè‡ªå·±è®­ç»ƒLoRAæ¨¡å‹çš„æ•™ç¨‹è§†é¢‘ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚<br>
è¿˜æœ‰æ›´é«˜çº§çš„ç©æ³•æ¯”å¦‚æŒ‡å®šåŠ¨ä½œä¹‹ç±»çš„ï¼Œç¯‡å¹…æ¯”è¾ƒå¤šï¼Œå…ˆå†™è¿™ä¹ˆå¤šï¼Œéšç¼˜æ›´æ–°ã€‚</p>
<h3 id="èµ„æº">èµ„æº</h3>
<ul>
<li><a href="https://pan.baidu.com/s/1DmLU6z-RkML5U4jVyeokSg?pwd=1234"target="_blank" rel="external nofollow noopener noreferrer">ç™¾åº¦ç›˜<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a></li>
</ul></div><div class="post-footer">
    <a href="/posts/ai_draw/">é˜…è¯»å…¨æ–‡</a><div class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/stable-diffusion/' class="post-tag">Stable Diffusion</a><a href='/tags/ai-%E7%BB%98%E7%94%BB/' class="post-tag">AI ç»˜ç”»</a></div></div>
</article>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
    <a href="/posts/springboot-openai/">ä½¿ç”¨springbootæ•´åˆOpenAIçš„Chatgpt apiå’ŒWhisper api</a>
  </h1><div class="post-meta"><span class="post-author"><span class="author"><img loading="lazy" src="/images/avatar.jpg" srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes="auto" data-title="waka" data-alt="waka" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;waka</span></span>&nbsp;<span class="post-publish" title='2023-03-13 22:41:46'>å‘å¸ƒäº <time datetime="2023-03-13">2023-03-13</time></span>&nbsp;<span class="post-category">æ”¶å½•äº <a href="/categories/java/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> java</a></span></div><div class="content"><h1 id="springbootchatgptwhisper-api">Springboot+Chatgpt+Whisper api</h1>
<p><img loading="lazy" src="https://www.qbitai.com/wp-content/uploads/2020/02/openai-cover-e1582087905568.png" srcset="https://www.qbitai.com/wp-content/uploads/2020/02/openai-cover-e1582087905568.png, https://www.qbitai.com/wp-content/uploads/2020/02/openai-cover-e1582087905568.png 1.5x, https://www.qbitai.com/wp-content/uploads/2020/02/openai-cover-e1582087905568.png 2x" sizes="auto" data-title="https://www.qbitai.com/wp-content/uploads/2020/02/openai-cover-e1582087905568.png" data-alt="https://www.qbitai.com/wp-content/uploads/2020/02/openai-cover-e1582087905568.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p>æœ¬æ–‡é€šè¿‡springbootå°†ä¸¤ä¸ªOpenAI APIçš„å…¶ä¸­ä¸¤ä¸ªï¼ŒChatGPTå’ŒWhisper APIé›†æˆåœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿åç»­çš„å¼€å‘ã€‚</p>
<h2 id="openai-api">OpenAI API</h2>
<p>OpenAIæ˜¯äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ å·¥å…·åŠAPIçš„é¢†å…ˆæä¾›å•†ä¹‹ä¸€ã€‚å®ƒè®­ç»ƒäº†å°–ç«¯çš„è¯­è¨€æ¨¡å‹ï¼Œæ“…é•¿ç†è§£å’Œç”Ÿæˆæ–‡æœ¬ã€‚OpenAI APIæä¾›å¯¹è¿™äº›æ¨¡å‹çš„è®¿é—®ï¼Œå¹¶å¯ç”¨äºè§£å†³å‡ ä¹æ¶‰åŠå¤„ç†è¯­è¨€çš„ä»»ä½•ä»»åŠ¡ã€‚å®ƒå¯ä»¥æ‰§è¡ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹ä»»åŠ¡ï¼š</p>
<ul>
<li>
<p>Content generation å†…å®¹ç”Ÿæˆ</p>
</li>
<li>
<p>Summarization æ€»ç»“</p>
</li>
<li>
<p>Classification, categorization, and sentiment analysis<br>
åˆ†ç±»ã€å½’ç±»å’Œæƒ…æ„Ÿåˆ†æ</p>
</li>
<li>
<p>Data extraction æ•°æ®æå–</p>
</li>
<li>
<p>Translation ç¿»è¯‘</p>
</li>
<li>
<p>Transcription è½¬å½•</p>
</li>
<li>
<p>Image generation å›¾åƒç”Ÿæˆ</p>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»»ä½•è¯­è¨€å‘å‡ºHTTPè¯·æ±‚ä¸APIè¿›è¡Œäº¤äº’ã€‚åœ¨æœ¬ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Javaæ„å»ºä¸€ä¸ªSpring Bootå¾®æœåŠ¡æ¥é›†æˆChatgpt APIå’ŒWhisper APIè¯­éŸ³è½¬æ–‡å­—åŠŸèƒ½ã€‚</p>
<h2 id="é›†æˆchatgpt-whisper-spring-boot">é›†æˆchatgpt-whisper-spring-boot</h2>
<ol>
<li>
<p>é¦–å…ˆæˆ‘ä»¬æ‰“å¼€IDEAæ–°å»ºä¸€ä¸ªspringbooté¡¹ç›®</p>
<p><img loading="lazy" src="https://thumbsnap.com/i/3Y6zzgX5.png" srcset="https://thumbsnap.com/i/3Y6zzgX5.png, https://thumbsnap.com/i/3Y6zzgX5.png 1.5x, https://thumbsnap.com/i/3Y6zzgX5.png 2x" sizes="auto" data-title="https://thumbsnap.com/i/3Y6zzgX5.png" data-alt="https://thumbsnap.com/i/3Y6zzgX5.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
</li>
<li>
<p>ç„¶åå¾€å…¶ä¸­çš„pom.xmlæ–‡ä»¶æ·»åŠ ä¾èµ–</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">org</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">springframework</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">boot</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">spring</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">boot</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">starter</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">web</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">org</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">springframework</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">cloud</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">spring</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">cloud</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">starter</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">openfeign</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">version</span><span style="color:#56b6c2">&gt;</span><span style="color:#d19a66">4.0.1</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">version</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">org</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">projectlombok</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">lombok</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">optional</span><span style="color:#56b6c2">&gt;</span><span style="color:#e5c07b">true</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">optional</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">org</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">springframework</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">boot</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">groupId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span><span style="color:#e06c75">spring</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">boot</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">configuration</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">processor</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">artifactId</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">optional</span><span style="color:#56b6c2">&gt;</span><span style="color:#e5c07b">true</span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">optional</span><span style="color:#56b6c2">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">&lt;/</span><span style="color:#e06c75">dependency</span><span style="color:#56b6c2">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<h2 id="spring-cloud-openfeign">Spring Cloud OpenFeign</h2>
<p>å¯¹äºç¬¬ä¸‰æ–¹REST APIé›†æˆï¼Œæœ‰è®¸å¤šå¯ä»¥ç”¨çš„å·¥å…·ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©Spring Cloud OpenFeignï¼Œå› ä¸ºè¿™ä¸ªå¯¹äºSpring Boot 3æ”¯æŒæ–¹é¢æ¯”è¾ƒå¥½ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ‰“å¼€ <code>application.yml</code>ï¼Œå¾€å…¶ä¸­æ·»åŠ ä¸‹é¢çš„å†…å®¹ï¼š</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#e06c75">openai</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">service</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">api</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">key</span><span style="color:#56b6c2">:</span> <span style="color:#e06c75">xxxxxxxxxx</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">gpt</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">model</span><span style="color:#56b6c2">:</span> <span style="color:#e06c75">gpt</span><span style="color:#56b6c2">-</span><span style="color:#d19a66">3.5</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">turbo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">audio</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">model</span><span style="color:#56b6c2">:</span> <span style="color:#e06c75">whisper</span><span style="color:#56b6c2">-</span><span style="color:#d19a66">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">http</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">client</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">read</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">timeout</span><span style="color:#56b6c2">:</span> <span style="color:#d19a66">60000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">connect</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">timeout</span><span style="color:#56b6c2">:</span> <span style="color:#d19a66">60000</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">urls</span><span style="color:#56b6c2">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">base</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">url</span><span style="color:#56b6c2">:</span> <span style="color:#e06c75">https</span><span style="color:#56b6c2">:</span><span style="color:#7f848e">//chat.579878700.xyz/v1
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#e06c75">chat</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">url</span><span style="color:#56b6c2">:</span> <span style="color:#56b6c2">/</span><span style="color:#e06c75">chat</span><span style="color:#56b6c2">/</span><span style="color:#e06c75">completions</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">create</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">transcription</span><span style="color:#56b6c2">-</span><span style="color:#e06c75">url</span><span style="color:#56b6c2">:</span> <span style="color:#56b6c2">/</span><span style="color:#e06c75">audio</span><span style="color:#56b6c2">/</span><span style="color:#e06c75">transcriptions</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­ <code> api-key</code>è¯·å¡«å†™è‡ªå·±çš„api keyï¼Œå¦‚æœæ‚¨è¿˜æ²¡æœ‰APIå¯†é’¥ï¼Œè¯·åˆ°<a href="https://platform.openai.com/account/api-keys"target="_blank" rel="external nofollow noopener noreferrer">https://platform.openai.com/account/api-keys<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a> ä»¥ç”ŸæˆAPIå¯†é’¥ã€‚å®é™…å¼€å‘ä¸­è¿™ç§é…ç½®è‚¯å®šè¦æ”¾åœ¨é…ç½®ä¸­å¿ƒé‡Œé¢ï¼Œä½†æ˜¯æˆ‘ä»¬ä»Šå¤©å…ˆç®€å•çš„å†™ä¸ªdemoã€‚</p>
<p><code>gpt-model</code> ï¼š <code>gpt-3.5-turbo</code> ï¼ŒåŠŸèƒ½æœ€å¼ºå¤§çš„GPT-3.5æ¨¡å‹ï¼Œé’ˆå¯¹èŠå¤©è¿›è¡Œäº†ä¼˜åŒ–ï¼Œæˆæœ¬ä»…ä¸º <code>text-davinci-003</code> çš„1/10ï¼Œå®ƒå¯ä»¥æ‰§è¡Œä»»ä½•è¯­è¨€ä»»åŠ¡ï¼Œè´¨é‡æ›´å¥½ï¼Œè¾“å‡ºæ›´é•¿ï¼ŒæŒ‡ä»¤ä¸€è‡´ã€‚</p>
<p><code>audio-model</code> ï¼š <code>whisper-1</code> ï¼Œé€šç”¨è¯­éŸ³è¯†åˆ«æ¨¡å‹ã€‚å®ƒæ˜¯åœ¨ä¸€ä¸ªå¤§å‹çš„å¤šæ ·åŒ–éŸ³é¢‘æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒçš„ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¤šä»»åŠ¡æ¨¡å‹ï¼Œå¯ä»¥æ‰§è¡Œå¤šè¯­è¨€è¯­éŸ³è¯†åˆ«ä»¥åŠè¯­éŸ³ç¿»è¯‘å’Œæ¥è‡ªä¸–ç•Œå„åœ°å¤§çº¦100ç§ä¸åŒè¯­è¨€çš„éŸ³é¢‘æ–‡ä»¶çš„è¯­è¨€è¯†åˆ«ã€‚</p>
<p><code> read-time</code>å’Œ<code> connect-time</code>å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ›´æ”¹ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨ä¸­æ–‡æ¥å›ç­”ï¼Œå› æ­¤æˆ‘è®¾ç½®çš„å¤§ä¸€äº›ï¼Œé¿å…å›ç­”è¿”å›æ—¶é—´å¤ªé•¿å¯¼è‡´è¶…æ—¶é—®é¢˜ã€‚</p>
<p><code> base-url</code>è¿™é‡Œæˆ‘å¡«å†™çš„æ˜¯æˆ‘ä½¿ç”¨CFè¿›è¡Œåä»£çš„åœ°å€ï¼Œå› ä¸ºä¸€äº›åŸå› ï¼Œopenai apiåœ¨ä¸­å›½ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œæ‰€ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æœä¸éœ€è¦ï¼Œè¯·æ”¹æˆ<code> https://api.openai.com/v1</code></p>
<p><code>urls</code> ï¼šæ ¹æ®OpenAI APIæ–‡æ¡£ï¼Œæ‰€æœ‰API URLå‡ä»¥ <code>[https://api.openai.com/v1](https://api.openai.com/v1)</code> å¼€å¤´ã€‚æˆ‘ä»¬å°†å…¶å®šä¹‰ä¸º <code>base-url</code> ã€‚å¯¹äºèŠå¤©åŠŸèƒ½ï¼Œ <code>chat-url</code> è¢«å®šä¹‰ä¸º <code>/chat/completions</code> ã€‚å¯¹äºéŸ³é¢‘è½¬å½•ï¼Œ <code>create-transcription-url</code> è¢«å®šä¹‰ä¸º <code>/audio/transcriptions</code> ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨ <code>/chat/completions</code> ç»§ç»­ä½¿ç”¨ <code>gpt-3.5-turbo</code> æ¨¡å‹ã€‚</p>
<h2 id="feign-client">Feign Client</h2>
<p>ç°åœ¨é…ç½®å·²ç»å®Œæˆï¼Œè®©æˆ‘ä»¬ç»§ç»­ç¼–å†™å£°æ˜å¼Feignå®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ–¹æ³•ï¼š <code>chat</code> å’Œ <code>createTranscription</code> ï¼Œè°ƒç”¨å®ƒä»¬å„è‡ªçš„OpenAI APIç«¯ç‚¹URLã€‚ä½ å¯ä»¥éšæ„å‘½åè¿™äº›æ–¹æ³•ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ <code>chat</code> å’Œ <code>createTranscription</code> ã€‚</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@FeignClient</span><span style="color:#56b6c2">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">name</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;openai-service&#34;</span><span style="color:#56b6c2">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">url</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;${openai-service.urls.base-url}&#34;</span><span style="color:#56b6c2">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">configuration</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">OpenAIClientConfig</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">class</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">)</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">interface</span> <span style="color:#e5c07b">OpenAIClient</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef">@PostMapping</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">value</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;${openai-service.urls.chat-url}&#34;</span><span style="color:#56b6c2">,</span> <span style="color:#e06c75">headers</span> <span style="color:#56b6c2">=</span> <span style="color:#56b6c2">{</span><span style="color:#98c379">&#34;Content-Type=application/json&#34;</span><span style="color:#56b6c2">})</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">ChatGPTResponse</span> <span style="color:#61afef;font-weight:bold">chat</span><span style="color:#56b6c2">(</span><span style="color:#61afef">@RequestBody</span> <span style="color:#e06c75">ChatGPTRequest</span> <span style="color:#e06c75">chatGPTRequest</span><span style="color:#56b6c2">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef">@PostMapping</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">value</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;${openai-service.urls.create-transcription-url}&#34;</span><span style="color:#56b6c2">,</span> <span style="color:#e06c75">headers</span> <span style="color:#56b6c2">=</span> <span style="color:#56b6c2">{</span><span style="color:#98c379">&#34;Content-Type=multipart/form-data&#34;</span><span style="color:#56b6c2">})</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">WhisperTranscriptionResponse</span> <span style="color:#61afef;font-weight:bold">createTranscription</span><span style="color:#56b6c2">(</span><span style="color:#61afef">@ModelAttribute</span> <span style="color:#e06c75">WhisperTranscriptionRequest</span> <span style="color:#e06c75">whisperTranscriptionRequest</span><span style="color:#56b6c2">);</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="models">Models</h2>
<p>é€šè¿‡ä¸¥æ ¼éµå¾ªAPIæ–‡æ¡£ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰è¯·æ±‚/å“åº”ç±»ã€‚è¯·å‚è§ä¸‹é¢ä½¿ç”¨ <code>gpt-3.5-turbo</code> æ¨¡å‹çš„ç¤ºä¾‹è¯·æ±‚å’Œå“åº”ç±»ã€‚æ³¨æ„ï¼Œä½¿ç”¨ <code>text-davinci-003</code> å®Œæˆçš„è¯·æ±‚/å“åº”ç•¥æœ‰ä¸åŒï¼Œæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…APIæ–‡æ¡£ã€‚</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@Data</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@Builder</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@AllArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@NoArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#e5c07b">ChatGPTRequest</span> <span style="color:#c678dd">implements</span> <span style="color:#e06c75">Serializable</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">String</span> <span style="color:#e06c75">model</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">List</span><span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">Message</span><span style="color:#56b6c2">&gt;</span> <span style="color:#e06c75">messages</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@Data</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#e5c07b">ChatGPTResponse</span> <span style="color:#c678dd">implements</span> <span style="color:#e06c75">Serializable</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">String</span> <span style="color:#e06c75">id</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">String</span> <span style="color:#e06c75">object</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">String</span> <span style="color:#e06c75">model</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">LocalDate</span> <span style="color:#e06c75">created</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">List</span><span style="color:#56b6c2">&lt;</span><span style="color:#e06c75">Choice</span><span style="color:#56b6c2">&gt;</span> <span style="color:#e06c75">choices</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">Usage</span> <span style="color:#e06c75">usage</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½¿ç”¨ Whisper æ¨¡å‹çš„éŸ³é¢‘è½¬å½•è¯·æ±‚/å“åº”ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@Data</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@Builder</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@AllArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@NoArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#e5c07b">TranscriptionRequest</span> <span style="color:#c678dd">implements</span> <span style="color:#e06c75">Serializable</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">MultipartFile</span> <span style="color:#e06c75">file</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@Data</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#e5c07b">WhisperTranscriptionResponse</span> <span style="color:#c678dd">implements</span> <span style="color:#e06c75">Serializable</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#e06c75">String</span> <span style="color:#e06c75">text</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="service">Service</h2>
<p>ä¸‹é¢æ˜¯æœåŠ¡å±‚ç±» <code>OpenAIClientService</code> ï¼Œæ„é€ æ¨¡å‹å¹¶è°ƒç”¨Feignclientä»¥è§¦å‘å¯¹OpenAI APIçš„è°ƒç”¨ã€‚</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@RequiredArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#e5c07b">OpenAIClientService</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">final</span> <span style="color:#e06c75">OpenAIClient</span> <span style="color:#e06c75">openAIClient</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">final</span> <span style="color:#e06c75">OpenAIClientConfig</span> <span style="color:#e06c75">openAIClientConfig</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">final</span> <span style="color:#c678dd">static</span> <span style="color:#e06c75">String</span> <span style="color:#e06c75">ROLE_USER</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;user&#34;</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#e06c75">ChatGPTResponse</span> <span style="color:#61afef;font-weight:bold">chat</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">ChatRequest</span> <span style="color:#e06c75">chatRequest</span><span style="color:#56b6c2">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">Message</span> <span style="color:#e06c75">message</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">Message</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">builder</span><span style="color:#56b6c2">()</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">role</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">ROLE_USER</span><span style="color:#56b6c2">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">content</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">chatRequest</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">getQuestion</span><span style="color:#56b6c2">())</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">build</span><span style="color:#56b6c2">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">ChatGPTRequest</span> <span style="color:#e06c75">chatGPTRequest</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">ChatGPTRequest</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">builder</span><span style="color:#56b6c2">()</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">model</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">openAIClientConfig</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">getModel</span><span style="color:#56b6c2">())</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">messages</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">Collections</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">singletonList</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">message</span><span style="color:#56b6c2">))</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">build</span><span style="color:#56b6c2">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">openAIClient</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">chat</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">chatGPTRequest</span><span style="color:#56b6c2">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#56b6c2">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#e06c75">WhisperTranscriptionResponse</span> <span style="color:#61afef;font-weight:bold">createTranscription</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">TranscriptionRequest</span> <span style="color:#e06c75">transcriptionRequest</span><span style="color:#56b6c2">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e06c75">WhisperTranscriptionRequest</span> <span style="color:#e06c75">whisperTranscriptionRequest</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">WhisperTranscriptionRequest</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">builder</span><span style="color:#56b6c2">()</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">model</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">openAIClientConfig</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">getAudioModel</span><span style="color:#56b6c2">())</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">file</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">transcriptionRequest</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">getFile</span><span style="color:#56b6c2">())</span>
</span></span><span style="display:flex;"><span>                <span style="color:#56b6c2">.</span><span style="color:#e06c75">build</span><span style="color:#56b6c2">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">openAIClient</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">createTranscription</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">whisperTranscriptionRequest</span><span style="color:#56b6c2">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#56b6c2">}</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯·æ³¨æ„ï¼Œé™¤äº†å¿…éœ€å‚æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨è¯·æ±‚æ­£æ–‡ä¸­ä¼ é€’å¤šä¸ªå¯é€‰å‚æ•°æ¥æŒ‡ç¤º OpenAI APIã€‚ä¾‹å¦‚ï¼Œå¯¹äº<code>/chat/completions</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥<code>temperature</code>å‚æ•°ï¼Œå®ƒå‘Šè¯‰ OpenAI API ä½¿ç”¨ä»€ä¹ˆé‡‡æ ·æ¸©åº¦ï¼Œä»‹äº 0 å’Œ 2 ä¹‹é—´ã€‚è¾ƒé«˜çš„å€¼å°†ä½¿è¾“å‡ºæ›´å…·éšæœºæ€§å’Œé£é™©æ€§ï¼Œè€Œè¾ƒä½çš„å€¼ä¼šä½¿å®ƒæ›´é›†ä¸­å’Œç¡®å®šæ€§ã€‚<code>temperature</code>å¦‚æœæˆ‘ä»¬ä¸æŒ‡å®šï¼Œé»˜è®¤å€¼ä¸º 1ã€‚è¯·å‚é˜…<a href="https://platform.openai.com/docs/api-reference"target="_blank" rel="external nofollow noopener noreferrer">OpenAI API æ–‡æ¡£ï¼Œ<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>äº†è§£æˆ‘ä»¬å¯ä»¥åœ¨è¯·æ±‚æ­£æ–‡ä¸­ä¼ é€’çš„æ‰€æœ‰å¯èƒ½çš„å‚æ•°ã€‚</p>
<h2 id="rest-controller-rest">REST Controller REST</h2>
<p>æœ€åï¼Œè®©æˆ‘ä»¬çœ‹çœ‹REST Controllerå±‚çš„ <code>OpenAIClientController</code> ï¼Œé‡Œé¢çš„ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼š</p>
<ul>
<li>
<p><code>chat</code> ï¼ˆ <code>/api/v1/chat</code> ï¼‰ï¼šPOSTè°ƒç”¨ï¼Œä½¿ç”¨JSONæ ¼å¼çš„æ¶ˆæ¯ï¼Œæ¥å—ä¸€ä¸ªé—®é¢˜ï¼Œå¹¶è¾“å‡ºå“åº”å†…å®¹ã€‚</p>
</li>
<li>
<p><code>createTranscription</code> ï¼ˆ <code>/api/v1/transcription</code> ï¼‰ï¼šPOSTè°ƒç”¨ï¼Œä½¿ç”¨multipart/form-dataï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶ï¼Œå¦‚ <code>m4a</code>å’Œ<code> mp3</code>ç­‰éŸ³é¢‘æ–‡ä»¶ ï¼ŒAPIå°†æŠŠéŸ³é¢‘æ–‡ä»¶è½¬å½•ä¸ºæ–‡æœ¬ã€‚</p>
</li>
</ul>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@RequiredArgsConstructor</span>
</span></span><span style="display:flex;"><span><span style="color:#61afef">@RequestMapping</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">value</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;/api/v1&#34;</span><span style="color:#56b6c2">)</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">public</span> <span style="color:#c678dd">class</span> <span style="color:#e5c07b">OpenAIClientController</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">private</span> <span style="color:#c678dd">final</span> <span style="color:#e06c75">OpenAIClientService</span> <span style="color:#e06c75">openAIClientService</span><span style="color:#56b6c2">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef">@PostMapping</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">value</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;/chat&#34;</span><span style="color:#56b6c2">,</span> <span style="color:#e06c75">consumes</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">MediaType</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">APPLICATION_JSON_VALUE</span><span style="color:#56b6c2">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#e06c75">ChatGPTResponse</span> <span style="color:#61afef;font-weight:bold">chat</span><span style="color:#56b6c2">(</span><span style="color:#61afef">@RequestBody</span> <span style="color:#e06c75">ChatRequest</span> <span style="color:#e06c75">chatRequest</span><span style="color:#56b6c2">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">openAIClientService</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">chat</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">chatRequest</span><span style="color:#56b6c2">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#56b6c2">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#61afef">@PostMapping</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">value</span> <span style="color:#56b6c2">=</span> <span style="color:#98c379">&#34;/transcription&#34;</span><span style="color:#56b6c2">,</span> <span style="color:#e06c75">consumes</span> <span style="color:#56b6c2">=</span> <span style="color:#e06c75">MediaType</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">MULTIPART_FORM_DATA_VALUE</span><span style="color:#56b6c2">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#e06c75">WhisperTranscriptionResponse</span> <span style="color:#61afef;font-weight:bold">createTranscription</span><span style="color:#56b6c2">(</span><span style="color:#61afef">@ModelAttribute</span> <span style="color:#e06c75">TranscriptionRequest</span> <span style="color:#e06c75">transcriptionRequest</span><span style="color:#56b6c2">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">openAIClientService</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">createTranscription</span><span style="color:#56b6c2">(</span><span style="color:#e06c75">transcriptionRequest</span><span style="color:#56b6c2">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#56b6c2">}</span>
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="authentication-è®¤è¯">Authentication è®¤è¯</h2>
<p>OpenAI APIè°ƒç”¨éœ€è¦ä¼ å…¥ä¸€ä¸ªå¸¦æœ‰APIå¯†é’¥çš„è¯·æ±‚å¤´â€œ <code>Authorization</code> â€œã€‚è®©æˆ‘ä»¬å£°æ˜ä¸€ä¸ª <code>RequestInterceptor </code>beanæ¥å¤„ç†å®ƒï¼Œå‚è§ <code>OpenAIClientConfig </code>ç±»çš„ç¤ºä¾‹ä»£ç ç‰‡æ®µï¼š</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#61afef">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#c678dd">public</span> <span style="color:#e06c75">RequestInterceptor</span> <span style="color:#61afef;font-weight:bold">apiKeyInterceptor</span><span style="color:#56b6c2">()</span> <span style="color:#56b6c2">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#c678dd">return</span> <span style="color:#e06c75">request</span> <span style="color:#56b6c2">-&gt;</span> <span style="color:#e06c75">request</span><span style="color:#56b6c2">.</span><span style="color:#e06c75">header</span><span style="color:#56b6c2">(</span><span style="color:#98c379">&#34;Authorization&#34;</span><span style="color:#56b6c2">,</span> <span style="color:#98c379">&#34;Bearer &#34;</span> <span style="color:#56b6c2">+</span> <span style="color:#e06c75">apiKey</span><span style="color:#56b6c2">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#56b6c2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æœ€åè¿è¡Œé¡¹ç›®">æœ€åè¿è¡Œé¡¹ç›®</h2>
<p>ç”¨Postmanæµ‹è¯•ä¸€ä¸‹</p>
<p>ä¸‹é¢æ˜¯ <code>/chat</code> å®¢æˆ·ç«¯çš„ç¤ºä¾‹è¯·æ±‚/å“åº”æˆªå›¾ï¼š</p>
<p><img loading="lazy" src="https://thumbsnap.com/i/vymQU5KY.png" srcset="https://thumbsnap.com/i/vymQU5KY.png, https://thumbsnap.com/i/vymQU5KY.png 1.5x, https://thumbsnap.com/i/vymQU5KY.png 2x" sizes="auto" data-title="https://thumbsnap.com/i/vymQU5KY.png" data-alt="https://thumbsnap.com/i/vymQU5KY.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p>ä¸‹é¢æ˜¯ <code>/transcription</code> çš„è¯·æ±‚/å“åº”ï¼š</p>
<p><img loading="lazy" src="https://thumbsnap.com/i/NbWLi3MG.png" srcset="https://thumbsnap.com/i/NbWLi3MG.png, https://thumbsnap.com/i/NbWLi3MG.png 1.5x, https://thumbsnap.com/i/NbWLi3MG.png 2x" sizes="auto" data-title="https://thumbsnap.com/i/NbWLi3MG.png" data-alt="https://thumbsnap.com/i/NbWLi3MG.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p>æ„Ÿè§‰å¯¹ä¸­æ–‡çš„è¯†åˆ«å‡†ç¡®åº¦è¿˜æ˜¯å¯ä»¥çš„ã€‚</p>
<p>ä½¿ç”¨Whisperæ¨¡å‹çš„éŸ³é¢‘è½¬å½•æˆ–ç¿»è¯‘ï¼Œæ–‡ä»¶ä¸Šä¼ ç›®å‰é™åˆ¶ä¸º25 MBï¼Œå¹¶æ”¯æŒä»¥ä¸‹è¾“å…¥æ–‡ä»¶ç±»å‹ï¼š<code>mp3</code>, <code>mp4</code>, <code>mpeg</code>, <code>mpga</code>, <code>m4a</code>, <code>wav</code>, <code>webm</code></p>
<p>Whisperå‹å·çš„å®šä»·ç›®å‰è®¾å®šä¸º0.006ç¾å…ƒ/åˆ†é’Ÿã€‚</p>
<h2 id="ä½¿ç”¨whisper-apiè¿›è¡ŒéŸ³é¢‘ç¿»è¯‘">ä½¿ç”¨Whisper APIè¿›è¡ŒéŸ³é¢‘ç¿»è¯‘</h2>
<p>é™¤äº†éŸ³é¢‘è½¬å½•ï¼ŒWhisper APIè¿˜æä¾›éŸ³é¢‘ç¿»è¯‘ç«¯ç‚¹ <code>/audio/translations</code> ã€‚æˆ‘ä¹Ÿæµ‹è¯•äº†è¿™ä¸ªç‰¹æ€§ã€‚ç„¶è€Œï¼Œæˆ‘å‘ç°ï¼Œå°½ç®¡å®ƒè¯´å¯ä»¥æŠŠéŸ³é¢‘ç¿»è¯‘æˆè‹±è¯­ï¼Œä½†æˆ‘å½•äº†ä¸€ä¸ªä¸­æ–‡çŸ­è¯­ï¼Œå¹¶åœ¨åº”ç”¨ç¨‹åºä¸­è°ƒç”¨äº† <code>/audio/translations</code> apiï¼Œç»“æœå‘ç°å›åº”ä»ç„¶æ˜¯ä¸­æ–‡ã€‚æˆ‘ä¹Ÿç”¨æ—¥è¯­æµ‹è¯•äº†è¿™ä¸ªapiï¼Œå®ƒå®Œæ•´çš„ç¿»è¯‘æˆäº†è‹±è¯­ã€‚è¿™åº”è¯¥æ˜¯ä¸€ä¸ªbugã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>ä¸ä»»ä½•ç¬¬ä¸‰æ–¹REST APIä¸€æ ·ï¼Œå°†OpenAI APIé›†æˆåˆ°Springbootä¸­éå¸¸ç®€å•ã€‚</p>
<p>å› æ­¤ä½¿ç”¨apiå¼€å‘è‡ªå·±çš„äººå·¥æ™ºèƒ½ç¨‹åºä¼šå˜çš„éå¸¸ä¾¿æ·ã€‚</p></div><div class="post-footer">
    <a href="/posts/springboot-openai/">é˜…è¯»å…¨æ–‡</a><div class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/springboot/' class="post-tag">springboot</a><a href='/tags/openai/' class="post-tag">openai</a></div></div>
</article>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
    <a href="/posts/ssi_book/">ã€ŠSelf-Sovereign Identityã€‹(ã€Šèº«ä»½è‡ªä¸»æƒã€‹ä¸­è‹±æ–‡ä¹¦ç±)</a>
  </h1><div class="post-meta"><span class="post-author"><span class="author"><img loading="lazy" src="/images/avatar.jpg" srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes="auto" data-title="waka" data-alt="waka" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;waka</span></span>&nbsp;<span class="post-publish" title='2023-03-05 23:27:33'>å‘å¸ƒäº <time datetime="2023-03-05">2023-03-05</time></span>&nbsp;<span class="post-category">æ”¶å½•äº <a href="/categories/%E4%B9%A6%E7%B1%8D%E5%88%86%E4%BA%AB/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> ä¹¦ç±åˆ†äº«</a>&ensp;<a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> åŒºå—é“¾</a>&ensp;<a href="/categories/did/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> did</a></span></div><div class="content"><h2 id="ç™¾åº¦ç½‘ç›˜ä¸‹è½½åœ°å€">ç™¾åº¦ç½‘ç›˜ä¸‹è½½åœ°å€</h2>
<blockquote>
<p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1ZkE_goWKyTMtZPdyZXRp7A?pwd=b0m1"target="_blank" rel="external nofollow noopener noreferrer">https://pan.baidu.com/s/1ZkE_goWKyTMtZPdyZXRp7A?pwd=b0m1<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden="true"></i></a>
æå–ç ï¼š<strong>b0m1</strong></p>
</blockquote>
<p>å› ä¸ºç½‘ä¸Šæ²¡æœ‰æ‰¾åˆ°ä¸­æ–‡ä¹¦ç±ï¼Œä½¿ç”¨äº†deeplæœºç¿»ï¼Œç¿»è¯‘çš„æ’ç‰ˆä¸æ˜¯å¾ˆå¥½ï¼Œä½†æ˜¯åŸºæœ¬èƒ½çœ‹æ‡‚ã€‚</p>
<h2 id="å†…å®¹ç®€ä»‹">å†…å®¹ç®€ä»‹</h2>
<p>â€‹	Self-Sovereign Identity gives you a radical new perspective on how we represent ourselves in the world. This case study-driven book cuts through the jargon and hype to expose the amazing potential SSI offers for for security, privacy, identity, and even uprooting way the global economy works. SSI experts Drummond Reed and Alex Preukschat present a vision of the future, examining how SSI protocols will impact industries from banking through to government. Youâ€™ll get a clear mental model for how SSI works as you tour SSI-enabled eCommerce and eHealth applications and their advantages over current technologies. While you learn the philosophical and sociological concepts that underpin SSI, youâ€™ll reach the bookâ€™s lightbulb moment: what this radical technology really means for the shape of our lives, our businesses, and our futures.</p>
<p>what&rsquo;s inside<br>
How SSI will affect your industry<br>
The essential technical and legal concepts of SSI<br>
The architecture of SSI software<br>
Emerging standards for SSI</p>
<p>â€‹	è‡ªæˆ‘ä¸»æƒèº«ä»½ &ldquo;ä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªå…³äºæˆ‘ä»¬å¦‚ä½•åœ¨ä¸–ç•Œä¸­ä»£è¡¨è‡ªå·±çš„å…¨æ–°è§†è§’ã€‚è¿™æœ¬ä»¥æ¡ˆä¾‹ç ”ç©¶ä¸ºå¯¼å‘çš„ä¹¦çªç ´äº†ä¸“ä¸šæœ¯è¯­å’Œç‚’ä½œï¼Œæ­ç¤ºäº†SSIä¸ºå®‰å…¨ã€éšç§ã€èº«ä»½ï¼Œç”šè‡³ä¸ºå…¨çƒç»æµè¿ä½œæ–¹å¼æä¾›çš„æƒŠäººæ½œåŠ›ã€‚SSIä¸“å®¶Drummond Reedå’ŒAlex Preukschatæå‡ºäº†æœªæ¥çš„æ„¿æ™¯ï¼Œç ”ç©¶äº†SSIåè®®å°†å¦‚ä½•å½±å“ä»é“¶è¡Œåˆ°æ”¿åºœçš„å„ä¸ªè¡Œä¸šã€‚å½“ä½ å‚è§‚SSIæ”¯æŒçš„ç”µå­å•†åŠ¡å’Œç”µå­åŒ»ç–—åº”ç”¨ä»¥åŠå®ƒä»¬ç›¸å¯¹äºå½“å‰æŠ€æœ¯çš„ä¼˜åŠ¿æ—¶ï¼Œä½ ä¼šå¯¹SSIå¦‚ä½•å·¥ä½œæœ‰ä¸€ä¸ªæ¸…æ™°çš„å¿ƒç†æ¨¡å‹ã€‚åœ¨ä½ å­¦ä¹ æ”¯æ’‘SSIçš„å“²å­¦å’Œç¤¾ä¼šå­¦æ¦‚å¿µçš„åŒæ—¶ï¼Œä½ å°†è¿æ¥æœ¬ä¹¦çš„é—ªå…‰æ—¶åˆ»ï¼šè¿™é¡¹æ¿€è¿›çš„æŠ€æœ¯å¯¹æˆ‘ä»¬çš„ç”Ÿæ´»ã€å•†ä¸šå’Œæœªæ¥çš„å½¢æ€æ„å‘³ç€ä»€ä¹ˆã€‚</p>
<p>ä¹¦ä¸­å†…å®¹<br>
SSIå°†å¦‚ä½•å½±å“ä½ çš„è¡Œä¸š<br>
SSIçš„åŸºæœ¬æŠ€æœ¯å’Œæ³•å¾‹æ¦‚å¿µ<br>
SSIè½¯ä»¶çš„æ¶æ„<br>
æ–°å…´çš„SSIæ ‡å‡†</p>
<p><img loading="lazy" src="s34243005.jpg" srcset="s34243005.jpg, s34243005.jpg 1.5x, s34243005.jpg 2x" sizes="auto" data-title="Self-Sovereign Identity" data-alt="Self-Sovereign Identity" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p></div><div class="post-footer">
    <a href="/posts/ssi_book/">é˜…è¯»å…¨æ–‡</a><div class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/self-sovereign-identity/' class="post-tag">Self-Sovereign Identity</a><a href='/tags/ssi/' class="post-tag">SSI</a><a href='/tags/%E8%BA%AB%E4%BB%BD%E8%87%AA%E4%B8%BB%E6%9D%83/' class="post-tag">èº«ä»½è‡ªä¸»æƒ</a><a href='/tags/did/' class="post-tag">did</a><a href='/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/' class="post-tag">åŒºå—é“¾</a></div></div>
</article>
<article class="single summary" itemscope itemtype="http://schema.org/Article"><h1 class="single-title" itemprop="name headline">
    <a href="/posts/merkle_tree_go/">é»˜å…‹å°”æ ‘(Merkle tree)çš„Goå®ç°</a>
  </h1><div class="post-meta"><span class="post-author"><span class="author"><img loading="lazy" src="/images/avatar.jpg" srcset="/images/avatar.jpg, /images/avatar.jpg 1.5x, /images/avatar.jpg 2x" sizes="auto" data-title="waka" data-alt="waka" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;waka</span></span>&nbsp;<span class="post-publish" title='2023-03-05 14:09:53'>å‘å¸ƒäº <time datetime="2023-03-05">2023-03-05</time></span>&nbsp;<span class="post-category">æ”¶å½•äº <a href="/categories/%E5%8C%BA%E5%9D%97%E9%93%BE/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> åŒºå—é“¾</a>&ensp;<a href="/categories/go/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Go</a></span></div><div class="content"><h3 id="merkle-trees">Merkle trees</h3>
<hr>
<p>Merkleæ ‘æ˜¯åŒºå—é“¾æŠ€æœ¯çš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ã€‚å®ƒæ˜¯ç”±ä¸åŒæ•°æ®å—çš„æ•£åˆ—ç»„æˆçš„æ•°å­¦æ•°æ®ç»“æ„ï¼Œç”¨ä½œå—ä¸­æ‰€æœ‰äº¤æ˜“çš„æ‘˜è¦ã€‚</p>
<p>å®ƒè¿˜å…è®¸å¯¹å¤§é‡æ•°æ®ä¸­çš„å†…å®¹è¿›è¡Œæœ‰æ•ˆå’Œå®‰å…¨çš„éªŒè¯ã€‚æ­¤ç»“æ„æœ‰åŠ©äºéªŒè¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå†…å®¹ã€‚æ¯”ç‰¹å¸å’Œä»¥å¤ªåŠéƒ½ä½¿ç”¨Merkleæ ‘ç»“æ„ã€‚Merkleæ ‘ä¹Ÿè¢«ç§°ä¸ºå“ˆå¸Œæ ‘ã€‚</p>
<p>ä»æ ¹æœ¬ä¸Šè¯´ï¼ŒMerkleæ ‘æ˜¯æ•°æ®ç»“æ„æ ‘ï¼Œå…¶ä¸­æ¯ä¸ªå¶èŠ‚ç‚¹éƒ½ç”¨æ•°æ®å—çš„å“ˆå¸Œæ ‡è®°ï¼Œéå¶èŠ‚ç‚¹ç”¨åŠ å¯†æ ‡è®° å…¶å­èŠ‚ç‚¹æ ‡ç­¾çš„å“ˆå¸Œå€¼ã€‚å¶èŠ‚ç‚¹æ˜¯æ ‘ä¸­çš„æœ€ä½èŠ‚ç‚¹ã€‚</p>
<p><img loading="lazy" src="https://img.learnblockchain.cn/attachments/2023/02/R9Yl2Xvj63e26ec555cc7.png" srcset="https://img.learnblockchain.cn/attachments/2023/02/R9Yl2Xvj63e26ec555cc7.png, https://img.learnblockchain.cn/attachments/2023/02/R9Yl2Xvj63e26ec555cc7.png 1.5x, https://img.learnblockchain.cn/attachments/2023/02/R9Yl2Xvj63e26ec555cc7.png 2x" sizes="auto" data-title="å›¾ç‰‡.png" data-alt="å›¾ç‰‡.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<h3 id="åŸç†">åŸç†</h3>
<p>åŒºå—é“¾ä¸­æ¯ä¸ªåŒºå—éƒ½ä¼šæœ‰ä¸€ä¸ª Merkle æ ‘ï¼Œå®ƒä»å¶å­èŠ‚ç‚¹ï¼ˆæ ‘çš„åº•éƒ¨ï¼‰å¼€å§‹ï¼Œä¸€ä¸ªå¶å­èŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªäº¤æ˜“å“ˆå¸Œã€‚å¶å­èŠ‚ç‚¹çš„æ•°é‡å¿…é¡»æ˜¯åŒæ•°ï¼Œä½†æ˜¯å¹¶éæ¯ä¸ªå—éƒ½åŒ…å«äº†åŒæ•°çš„äº¤æ˜“ã€‚å¦‚æœä¸€ä¸ªå—é‡Œé¢çš„äº¤æ˜“æ•°ä¸ºå•æ•°ï¼Œé‚£ä¹ˆå°±å°†æœ€åä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯ Merkle æ ‘çš„æœ€åä¸€ä¸ªäº¤æ˜“ï¼Œä¸æ˜¯åŒºå—çš„æœ€åä¸€ç¬”äº¤æ˜“ï¼‰å¤åˆ¶ä¸€ä»½å‡‘æˆåŒæ•°ã€‚</p>
<p>ä»ä¸‹å¾€ä¸Šï¼Œä¸¤ä¸¤æˆå¯¹ï¼Œè¿æ¥ä¸¤ä¸ªèŠ‚ç‚¹å“ˆå¸Œï¼Œå°†ç»„åˆå“ˆå¸Œä½œä¸ºæ–°çš„å“ˆå¸Œã€‚æ–°çš„å“ˆå¸Œå°±æˆä¸ºæ–°çš„æ ‘èŠ‚ç‚¹ã€‚é‡å¤è¯¥è¿‡ç¨‹ï¼Œç›´åˆ°ä»…æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯æ ‘æ ¹ã€‚æ ¹å“ˆå¸Œç„¶åå°±ä¼šå½“ä½œæ˜¯æ•´ä¸ªå—äº¤æ˜“çš„å”¯ä¸€æ ‡ç¤ºï¼Œå°†å®ƒä¿å­˜åˆ°åŒºå—å¤´ï¼Œç„¶åç”¨äºå·¥ä½œé‡è¯æ˜ã€‚</p>
<hr>
<h3 id="ä»£ç å®ç°">ä»£ç å®ç°</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">108
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;bufio&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;crypto/sha256&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;strconv&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">//é»˜å…‹å°”æ ‘èŠ‚ç‚¹ç»“æ„ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Node</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Index</span>    <span style="color:#e5c07b">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Value</span>    <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">RootTree</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">MHTree</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">//é»˜å…‹å°”æ ‘ç»“æ„ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">type</span> <span style="color:#e06c75">MHTree</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Length</span>   <span style="color:#e5c07b">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Nodes</span>    []<span style="color:#e06c75">Node</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">rootHash</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">//è·å¾—é»˜å…‹å°”æ ‘æ ¹èŠ‚ç‚¹å“ˆå¸Œå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">t</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">MHTree</span>) <span style="color:#61afef;font-weight:bold">GetRootHash</span>() <span style="color:#e5c07b">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//ä¸ç®¡æ˜¯å¦å­˜å‚¨ï¼Œéƒ½é‡æ–°è®¡ç®—å“ˆå¸Œå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">t</span>.<span style="color:#e06c75">rootHash</span> =   <span style="color:#e06c75">t</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#d19a66">1</span>].<span style="color:#61afef;font-weight:bold">getNodeHash</span>()                            
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> <span style="color:#e06c75">t</span>.<span style="color:#e06c75">rootHash</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">//è®¡ç®—é»˜å…‹å°”æ ‘ä¸­æŸä¸ªèŠ‚ç‚¹çš„å“ˆå¸Œå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Node</span>) <span style="color:#61afef;font-weight:bold">getNodeHash</span>() <span style="color:#e5c07b">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//å¶å­èŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥è®¡ç®—è¯¥èŠ‚ç‚¹Valueçš„å“ˆå¸Œå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">n</span>.<span style="color:#e06c75">Value</span> <span style="color:#56b6c2">!=</span> <span style="color:#98c379">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span> <span style="color:#61afef;font-weight:bold">calDataHash</span>(<span style="color:#e06c75">n</span>.<span style="color:#e06c75">Value</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//éå¶å­èŠ‚ç‚¹ï¼Œåˆ™é€’å½’è®¡ç®—å“ˆå¸Œå€¼,å…¶ä¸º2ä¸ªå­èŠ‚ç‚¹å“ˆå¸Œå€¼çš„å“ˆå¸Œå€¼123123123123
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#c678dd">return</span> <span style="color:#61afef;font-weight:bold">calDataHash</span>(<span style="color:#e06c75">n</span>.<span style="color:#e06c75">RootTree</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#e06c75">n</span>.<span style="color:#e06c75">Index</span><span style="color:#56b6c2">*</span><span style="color:#d19a66">2</span>].<span style="color:#61afef;font-weight:bold">getNodeHash</span>() <span style="color:#56b6c2">+</span> <span style="color:#e06c75">n</span>.<span style="color:#e06c75">RootTree</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#e06c75">n</span>.<span style="color:#e06c75">Index</span><span style="color:#56b6c2">*</span><span style="color:#d19a66">2</span><span style="color:#56b6c2">+</span><span style="color:#d19a66">1</span>].<span style="color:#61afef;font-weight:bold">getNodeHash</span>()
</span></span><span style="display:flex;"><span>        )                                                         
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">//è®¡ç®—æ•°æ®çš„å“ˆå¸Œå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">calDataHash</span>(<span style="color:#e06c75">data</span> <span style="color:#e5c07b">string</span>) <span style="color:#e5c07b">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">hash</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">sha256</span>.<span style="color:#61afef;font-weight:bold">New</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">hash</span>.<span style="color:#61afef;font-weight:bold">Write</span>([]<span style="color:#e5c07b">byte</span>(<span style="color:#e06c75">data</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> <span style="color:#e5c07b">string</span>(<span style="color:#e06c75">hash</span>.<span style="color:#61afef;font-weight:bold">Sum</span>(<span style="color:#e5c07b">nil</span>))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">//ä»ç»“æ„åŒ–æ–‡ä»¶åˆ›å»ºé»˜å…‹å°”æ ‘
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">CreateMHTree</span>(<span style="color:#e06c75">fileName</span> <span style="color:#e5c07b">string</span>) <span style="color:#e06c75">MHTree</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">tree</span> <span style="color:#e06c75">MHTree</span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//æ‰“å¼€æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">file</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">os</span>.<span style="color:#61afef;font-weight:bold">Open</span>(<span style="color:#e06c75">fileName</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e5c07b">panic</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">file</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//è·å–è¯»å–å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">buf</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">bufio</span>.<span style="color:#61afef;font-weight:bold">NewReader</span>(<span style="color:#e06c75">file</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//è¯»å–é¦–è¡Œï¼Œè·å¾—å¶å­èŠ‚ç‚¹æ•°ç›®ï¼ˆè¦æ±‚å¶å­èŠ‚ç‚¹æ•°ç›®ä¸º2çš„æ•´æ•°æ¬¡å¹‚
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">dataCountStr</span>, <span style="color:#e06c75">_</span>, <span style="color:#e06c75">_</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">buf</span>.<span style="color:#61afef;font-weight:bold">ReadLine</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">dataCount</span>, <span style="color:#e06c75">_</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">strconv</span>.<span style="color:#61afef;font-weight:bold">Atoi</span>(<span style="color:#e5c07b">string</span>(<span style="color:#e06c75">dataCountStr</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//åˆ¤æ–­å¹‚æ¬¡
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">level</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">0</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">i</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">1</span>; ; <span style="color:#e06c75">i</span><span style="color:#56b6c2">++</span> {                                          
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#d19a66">2</span><span style="color:#56b6c2">&lt;&lt;</span><span style="color:#e06c75">i</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">dataCount</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">level</span> = <span style="color:#e06c75">i</span>
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">break</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//åˆ›å»ºé»˜å…‹å°”æ ‘
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//ç»™éå¶å­èŠ‚ç‚¹èµ‹å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">i</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">1</span>; <span style="color:#e06c75">i</span> <span style="color:#56b6c2">&lt;=</span> <span style="color:#d19a66">2</span><span style="color:#56b6c2">&lt;&lt;</span><span style="color:#e06c75">level</span><span style="color:#56b6c2">-</span><span style="color:#d19a66">1</span>; <span style="color:#e06c75">i</span><span style="color:#56b6c2">++</span> {                               
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">tree</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#e06c75">i</span>].<span style="color:#e06c75">Index</span> = <span style="color:#e06c75">i</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">tree</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#e06c75">i</span>].<span style="color:#e06c75">RootTree</span> = <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">tree</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">//è¯»å–æ–‡ä»¶æ•°æ®ï¼Œç»™å¶å­èŠ‚ç‚¹èµ‹å€¼
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">i</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">2</span> <span style="color:#56b6c2">&lt;&lt;</span> <span style="color:#e06c75">level</span>; <span style="color:#e06c75">i</span> &lt; <span style="color:#e06c75">tree</span>.<span style="color:#e06c75">Length</span>; <span style="color:#e06c75">i</span><span style="color:#56b6c2">++</span> {                  
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">str</span>, <span style="color:#e06c75">_</span>, <span style="color:#e06c75">_</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">buf</span>.<span style="color:#61afef;font-weight:bold">ReadLine</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">tree</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#e06c75">i</span>].<span style="color:#e06c75">Index</span> = <span style="color:#e06c75">i</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">tree</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#e06c75">i</span>].<span style="color:#e06c75">RootTree</span> = <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">tree</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">tree</span>.<span style="color:#e06c75">Nodes</span>[<span style="color:#e06c75">i</span>].<span style="color:#e06c75">Value</span> = <span style="color:#e5c07b">string</span>(<span style="color:#e06c75">str</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> <span style="color:#e06c75">tree</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">fileName</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Println</span>(<span style="color:#98c379">&#34;è¯·è¾“å…¥åŸå§‹æ•°æ®æ–‡ä»¶åç§°&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Scanln</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">fileName</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">mhTree1</span> <span style="color:#56b6c2">:=</span> <span style="color:#61afef;font-weight:bold">CreateMHTree</span>(<span style="color:#e06c75">fileName</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Println</span>(<span style="color:#98c379">&#34;è¯·è¾“å…¥æ¯”å¯¹æ•°æ®æ–‡ä»¶åç§°&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Scanln</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">fileName</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">mhTree2</span> <span style="color:#56b6c2">:=</span> <span style="color:#61afef;font-weight:bold">CreateMHTree</span>(<span style="color:#e06c75">fileName</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">hash1</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">mhTree1</span>.<span style="color:#61afef;font-weight:bold">GetRootHash</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">hash2</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">mhTree2</span>.<span style="color:#61afef;font-weight:bold">GetRootHash</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">hash1</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">hash2</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Println</span>(<span style="color:#98c379">&#34;ç”¨æˆ·æ²¡æœ‰æ”¹å˜æ•°æ®&#34;</span>)
</span></span><span style="display:flex;"><span>	} <span style="color:#c678dd">else</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Println</span>(<span style="color:#98c379">&#34;ç”¨æˆ·æ”¹å˜äº†æ•°æ®&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer">
    <a href="/posts/merkle_tree_go/">é˜…è¯»å…¨æ–‡</a><div class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/merkle-tree/' class="post-tag">Merkle tree</a><a href='/tags/go/' class="post-tag">Go</a></div></div>
</article>
<ul class="pagination"><li class="page-item active">
          <span class="page-link">
            <a href="/">1</a>
          </span>
        </li><li class="page-item">
          <span class="page-link">
            <a href="/page/2/">2</a>
          </span>
        </li></ul></div></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">ç”± <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.111.1">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.2.18-RC"><img class="fixit-icon" src="/fixit.min.svg" alt="FixIt logo" />&nbsp;FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div><div class="footer-line statistics"></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="å›åˆ°é¡¶éƒ¨"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt ä¸»é¢˜åœ¨å¯ç”¨ JavaScript çš„æƒ…å†µä¸‹æ•ˆæœæœ€ä½³ã€‚</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/lunr/lunr.min.js" defer></script><script src="/lib/lunr/lunr.stemmer.support.min.js" defer></script><script src="/lib/lunr/lunr.zh.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","editLockTitle":"é”å®šå¯ç¼–è¾‘ä»£ç å—","editUnLockTitle":"è§£é”å¯ç¼–è¾‘ä»£ç å—","editable":true,"maxShownLines":10},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒã€‚"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"data":{"typeit-profile-subtitle":"è¿™æ˜¯æˆ‘çš„blog"},"enablePWA":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"typeit-header-subtitle-desktop":["typeit-header-subtitle-desktop"],"typeit-header-subtitle-mobile":["typeit-header-subtitle-mobile"],"typeit-profile-subtitle":["typeit-profile-subtitle"]},"duration":6,"speed":100}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
